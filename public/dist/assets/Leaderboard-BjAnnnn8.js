import{d as I,r as C,p as E,q as M,g as i,i as e,h as b,n as c,m as u,t as n,F as D,l as G,j as S,w as T,f as $,o as d,D as m,A as W}from"./vendor-CZScdcBs.js";import{l as y}from"./index-CAiYc5NE.js";const N=I("leaderboard",{state:()=>({globalLeaderboard:[],weeklyLeaderboard:[],monthlyLeaderboard:[],userRank:{global:null,weekly:null,monthly:null},isLoading:!1,lastUpdate:null,autoRefreshInterval:null,autoRefreshEnabled:!0}),getters:{topGlobal:t=>t.globalLeaderboard.slice(0,10),topWeekly:t=>t.weeklyLeaderboard.slice(0,10),topMonthly:t=>t.monthlyLeaderboard.slice(0,10),isUserInTop10Global:t=>t.userRank.global&&t.userRank.global<=10,isUserInTop10Weekly:t=>t.userRank.weekly&&t.userRank.weekly<=10,isUserInTop10Monthly:t=>t.userRank.monthly&&t.userRank.monthly<=10,timeSinceUpdate:t=>{if(!t.lastUpdate)return null;const o=Math.floor((Date.now()-t.lastUpdate)/1e3);return o<60?`${o}s`:o<3600?`${Math.floor(o/60)}m`:`${Math.floor(o/3600)}h`}},actions:{async loadGlobalLeaderboard(){try{this.isLoading=!0;const t=await y.getGlobal();this.globalLeaderboard=t.data.leaderboard,this.userRank.global=t.data.user_rank,this.lastUpdate=Date.now()}catch(t){console.error("Failed to load global leaderboard:",t)}finally{this.isLoading=!1}},async loadWeeklyLeaderboard(){try{this.isLoading=!0;const t=await y.getWeekly();this.weeklyLeaderboard=t.data.leaderboard,this.userRank.weekly=t.data.user_rank,this.lastUpdate=Date.now()}catch(t){console.error("Failed to load weekly leaderboard:",t)}finally{this.isLoading=!1}},async loadMonthlyLeaderboard(){try{this.isLoading=!0;const t=await y.getMonthly();this.monthlyLeaderboard=t.data.leaderboard,this.userRank.monthly=t.data.user_rank,this.lastUpdate=Date.now()}catch(t){console.error("Failed to load monthly leaderboard:",t)}finally{this.isLoading=!1}},async loadAllLeaderboards(){await Promise.all([this.loadGlobalLeaderboard(),this.loadWeeklyLeaderboard(),this.loadMonthlyLeaderboard()])},startAutoRefresh(){this.autoRefreshInterval||(this.autoRefreshEnabled=!0,this.autoRefreshInterval=setInterval(()=>{this.autoRefreshEnabled&&this.loadAllLeaderboards()},3e4))},stopAutoRefresh(){this.autoRefreshInterval&&(clearInterval(this.autoRefreshInterval),this.autoRefreshInterval=null),this.autoRefreshEnabled=!1},toggleAutoRefresh(){this.autoRefreshEnabled=!this.autoRefreshEnabled,this.autoRefreshEnabled&&!this.autoRefreshInterval&&this.startAutoRefresh()},async refresh(){await this.loadAllLeaderboards()},getRankColor(t){return t===1?"text-yellow-500":t===2?"text-gray-400":t===3?"text-orange-600":"text-gray-700"},getRankEmoji(t){return t===1?"ğŸ¥‡":t===2?"ğŸ¥ˆ":t===3?"ğŸ¥‰":`#${t}`}}}),j={class:"max-w-6xl mx-auto space-y-6"},F={class:"card"},Q={class:"flex items-center justify-between"},V={class:"flex items-center gap-3"},q={key:0},B={key:1},P=["disabled"],Z={key:0},H={key:1},J={key:0,class:"mt-3 text-sm text-gray-500"},K={class:"card bg-gradient-to-r from-indigo-500 to-purple-600 text-white"},O={class:"flex items-center justify-between"},X={class:"text-3xl font-bold"},Y={class:"text-right"},ee={class:"text-sm opacity-90 mb-1"},te={class:"text-lg"},se={class:"card"},oe={class:"flex gap-4 border-b border-gray-200"},re={key:0,class:"card text-center py-12"},ae={key:1,class:"card overflow-hidden"},le={class:"overflow-x-auto"},ne={class:"w-full"},ie={class:"bg-white divide-y divide-gray-200"},de={class:"px-6 py-4 whitespace-nowrap"},ue={class:"flex items-center"},ce={class:"px-6 py-4 whitespace-nowrap"},he={class:"flex items-center"},ge={class:"w-10 h-10 rounded-full bg-gradient-to-r from-indigo-500 to-purple-600 flex items-center justify-center text-white font-bold"},xe={class:"ml-3"},be={class:"text-sm font-medium text-gray-900"},ye={key:0,class:"ml-2 text-indigo-600 font-bold"},fe={class:"px-6 py-4 whitespace-nowrap"},me={class:"text-sm font-bold text-indigo-600"},pe={class:"px-6 py-4 whitespace-nowrap"},ve={class:"text-sm text-gray-900"},_e={class:"px-6 py-4 whitespace-nowrap"},ke={class:"flex items-center"},we={class:"ml-2 w-16 bg-gray-200 rounded-full h-2"},Re={class:"px-6 py-4 whitespace-nowrap"},Le={class:"flex items-center"},Ae={class:"text-sm font-medium text-gray-900"},Ue={class:"ml-1 text-xs text-gray-500"},ze={key:2,class:"card text-center py-12"},Ie={key:3,class:"grid grid-cols-1 md:grid-cols-3 gap-4"},Ce={class:"card text-center"},Ee={class:"text-2xl font-bold text-gray-900"},Me={class:"card text-center"},De={class:"text-2xl font-bold text-gray-900"},Ge={class:"card text-center"},Se={class:"text-2xl font-bold text-gray-900"},We={__name:"Leaderboard",setup(t){const o=N(),r=C("global");E(()=>{o.loadAllLeaderboards(),o.startAutoRefresh()}),M(()=>{o.stopAutoRefresh()});const h=()=>r.value==="global"?o.topGlobal:r.value==="weekly"?o.topWeekly:r.value==="monthly"?o.topMonthly:[],p=()=>r.value==="global"?o.userRank.global?`#${o.userRank.global}`:"-":r.value==="weekly"?o.userRank.weekly?`#${o.userRank.weekly}`:"-":r.value==="monthly"&&o.userRank.monthly?`#${o.userRank.monthly}`:"-",v=()=>r.value==="global"?o.isUserInTop10Global:r.value==="weekly"?o.isUserInTop10Weekly:r.value==="monthly"?o.isUserInTop10Monthly:!1,_=()=>r.value==="global"?"Global":r.value==="weekly"?"Diese Woche":r.value==="monthly"?"Dieser Monat":"",k=a=>new Intl.NumberFormat("de-DE").format(a),w=a=>a>=90?"text-green-600":a>=70?"text-yellow-600":"text-orange-600",R=a=>a>=90?"bg-green-500":a>=70?"bg-yellow-500":"bg-orange-500",L=a=>a>=50?"ğŸ”¥":a>=30?"â­":a>=10?"âœ¨":"ğŸŒŸ",A=()=>{const a=h();if(a.length===0)return 0;const s=a.reduce((g,x)=>g+x.accuracy,0);return Math.round(s/a.length)},U=()=>h().reduce((s,g)=>s+g.quizzes_completed,0),z=async()=>{await o.refresh()};return(a,s)=>{var x;const g=$("router-link");return d(),i("div",j,[e("div",F,[e("div",Q,[s[4]||(s[4]=e("div",null,[e("h1",{class:"text-3xl font-bold text-gray-900 mb-2"},"ğŸ† Leaderboard"),e("p",{class:"text-gray-600"},"Vergleiche dich mit den besten Spielern")],-1)),e("div",V,[e("button",{onClick:s[0]||(s[0]=l=>u(o).toggleAutoRefresh()),class:c(["px-4 py-2 rounded-lg border-2 transition-colors text-sm font-medium",u(o).autoRefreshEnabled?"border-green-500 bg-green-50 text-green-700":"border-gray-300 text-gray-700"])},[u(o).autoRefreshEnabled?(d(),i("span",q,"ğŸ”„ Auto-Update AN")):(d(),i("span",B,"â¸ï¸ Auto-Update AUS"))],2),e("button",{onClick:z,disabled:u(o).isLoading,class:"btn-primary"},[u(o).isLoading?(d(),i("span",Z,"LÃ¤dt...")):(d(),i("span",H,"ğŸ”„ Aktualisieren"))],8,P)])]),u(o).lastUpdate?(d(),i("div",J," Zuletzt aktualisiert: vor "+n(u(o).timeSinceUpdate),1)):b("",!0)]),e("div",K,[e("div",O,[e("div",null,[s[5]||(s[5]=e("div",{class:"text-sm opacity-90 mb-1"},"Deine Position",-1)),e("div",X,n(p()),1)]),e("div",Y,[e("div",ee,n(_()),1),e("div",te,n(v()?"ğŸ‰ Top 10!":"Weiter so!"),1)])])]),e("div",se,[e("div",oe,[e("button",{onClick:s[1]||(s[1]=l=>r.value="global"),class:c(["px-4 py-2 font-medium transition-colors",r.value==="global"?"text-indigo-600 border-b-2 border-indigo-600":"text-gray-600 hover:text-gray-900"])}," ğŸŒ Global ",2),e("button",{onClick:s[2]||(s[2]=l=>r.value="weekly"),class:c(["px-4 py-2 font-medium transition-colors",r.value==="weekly"?"text-indigo-600 border-b-2 border-indigo-600":"text-gray-600 hover:text-gray-900"])}," ğŸ“… WÃ¶chentlich ",2),e("button",{onClick:s[3]||(s[3]=l=>r.value="monthly"),class:c(["px-4 py-2 font-medium transition-colors",r.value==="monthly"?"text-indigo-600 border-b-2 border-indigo-600":"text-gray-600 hover:text-gray-900"])}," ğŸ“† Monatlich ",2)])]),u(o).isLoading&&h().length===0?(d(),i("div",re,[...s[6]||(s[6]=[e("div",{class:"spinner mx-auto mb-4"},null,-1),e("p",{class:"text-gray-600"},"Lade Leaderboard...",-1)])])):h().length>0?(d(),i("div",ae,[e("div",le,[e("table",ne,[s[7]||(s[7]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Rang "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Spieler "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Punkte "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Quizzes "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Genauigkeit "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Level ")])],-1)),e("tbody",ie,[(d(!0),i(D,null,G(h(),(l,f)=>(d(),i("tr",{key:l.user_id,class:c(["hover:bg-gray-50 transition-colors",l.is_current_user?"bg-indigo-50":""])},[e("td",de,[e("div",ue,[e("span",{class:c(["text-2xl font-bold",u(o).getRankColor(f+1)])},n(u(o).getRankEmoji(f+1)),3)])]),e("td",ce,[e("div",he,[e("div",ge,n(l.username.charAt(0).toUpperCase()),1),e("div",xe,[e("div",be,[m(n(l.username)+" ",1),l.is_current_user?(d(),i("span",ye,"(Du)")):b("",!0)])])])]),e("td",fe,[e("div",me,n(k(l.total_points)),1)]),e("td",pe,[e("div",ve,n(l.quizzes_completed),1)]),e("td",_e,[e("div",ke,[e("div",{class:c(["text-sm font-medium",w(l.accuracy)])},n(l.accuracy)+"% ",3),e("div",we,[e("div",{class:c(["h-2 rounded-full transition-all",R(l.accuracy)]),style:W({width:l.accuracy+"%"})},null,6)])])]),e("td",Re,[e("div",Le,[e("span",Ae,n(l.level),1),e("span",Ue,n(L(l.level)),1)])])],2))),128))])])])])):(d(),i("div",ze,[s[9]||(s[9]=e("div",{class:"text-6xl mb-4"},"ğŸ“Š",-1)),s[10]||(s[10]=e("h3",{class:"text-xl font-bold text-gray-900 mb-2"},"Noch keine Daten",-1)),s[11]||(s[11]=e("p",{class:"text-gray-600 mb-4"},"Spiele Quizzes um im Leaderboard zu erscheinen!",-1)),S(g,{to:"/quiz",class:"btn-primary"},{default:T(()=>[...s[8]||(s[8]=[m(" Quiz spielen ",-1)])]),_:1})])),h().length>0?(d(),i("div",Ie,[e("div",Ce,[s[12]||(s[12]=e("div",{class:"text-3xl mb-2"},"ğŸ‘‘",-1)),e("div",Ee,n(((x=h()[0])==null?void 0:x.username)||"-"),1),s[13]||(s[13]=e("div",{class:"text-sm text-gray-600"},"FÃ¼hrender Spieler",-1))]),e("div",Me,[s[14]||(s[14]=e("div",{class:"text-3xl mb-2"},"ğŸ¯",-1)),e("div",De,n(A())+"%",1),s[15]||(s[15]=e("div",{class:"text-sm text-gray-600"},"Durchschnittliche Genauigkeit",-1))]),e("div",Ge,[s[16]||(s[16]=e("div",{class:"text-3xl mb-2"},"ğŸƒ",-1)),e("div",Se,n(U()),1),s[17]||(s[17]=e("div",{class:"text-sm text-gray-600"},"Gespielte Quizzes",-1))])])):b("",!0)])}}};export{We as default};
