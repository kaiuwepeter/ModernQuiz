import{d as T,r as v,p as I,q as F,g as c,h as f,m as n,i as t,F as y,l as w,t as o,A as S,n as x,j as M,w as D,f as P,o as d,D as R}from"./vendor-CZScdcBs.js";import{q as p}from"./index-BJH1VQOg.js";const G=T("quiz",{state:()=>({sessionId:null,currentQuestion:null,questionNumber:0,totalQuestions:10,score:0,correctAnswers:0,answers:[],categories:[],selectedCategory:null,isLoading:!1,quizActive:!1,timeLeft:30,timerInterval:null,excludedQuestions:[]}),getters:{progress:i=>i.questionNumber/i.totalQuestions*100,accuracy:i=>i.answers.length>0?Math.round(i.correctAnswers/i.answers.length*100):0},actions:{async loadCategories(){try{const i=await p.getCategories();this.categories=i.data}catch(i){console.error("Failed to load categories:",i)}},async startQuiz(i=null){try{this.isLoading=!0,this.selectedCategory=i,this.questionNumber=0,this.score=0,this.correctAnswers=0,this.answers=[],this.excludedQuestions=[];const e=await p.startSession(i);this.sessionId=e.data.session_id,await this.loadNextQuestion(),this.quizActive=!0}catch(e){console.error("Failed to start quiz:",e),this.isLoading=!1}},async loadNextQuestion(){try{this.isLoading=!0;const i=await p.getQuestion(this.selectedCategory,this.excludedQuestions);if(!i.data){await this.endQuiz();return}this.currentQuestion=i.data,this.excludedQuestions.push(i.data.id),this.questionNumber++,this.timeLeft=i.data.time_limit||30,this.startTimer(),this.isLoading=!1}catch(i){console.error("Failed to load question:",i),this.isLoading=!1}},async submitAnswer(i,e){try{this.stopTimer(),this.isLoading=!0;const a=(await p.submitAnswer(this.sessionId,this.currentQuestion.id,i,e)).data;return this.answers.push({questionId:this.currentQuestion.id,answerId:i,correct:a.correct,points:a.points_earned,explanation:a.explanation}),a.correct&&(this.correctAnswers++,this.score+=a.points_earned),this.isLoading=!1,this.questionNumber>=this.totalQuestions&&await this.endQuiz(),a}catch(u){throw console.error("Failed to submit answer:",u),this.isLoading=!1,u}},async endQuiz(){try{this.stopTimer();const i=await p.endSession(this.sessionId);return this.quizActive=!1,i.data.referral_bonus?{...i.data,bonusUnlocked:!0}:i.data}catch(i){console.error("Failed to end quiz:",i),this.quizActive=!1}},startTimer(){this.stopTimer(),this.timerInterval=setInterval(()=>{this.timeLeft>0?this.timeLeft--:this.handleTimeout()},1e3)},stopTimer(){this.timerInterval&&(clearInterval(this.timerInterval),this.timerInterval=null)},async handleTimeout(){var i,e;this.stopTimer(),(e=(i=this.currentQuestion)==null?void 0:i.answers)!=null&&e[0]&&await this.submitAnswer(this.currentQuestion.answers[0].id,this.currentQuestion.time_limit)},resetQuiz(){this.stopTimer(),this.sessionId=null,this.currentQuestion=null,this.questionNumber=0,this.score=0,this.correctAnswers=0,this.answers=[],this.quizActive=!1,this.excludedQuestions=[]}}}),j={class:"max-w-4xl mx-auto space-y-6"},E={key:0,class:"space-y-6"},V={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},W=["onClick"],B={class:"text-4xl mb-2"},K={class:"font-bold text-gray-900 group-hover:text-indigo-600"},U={class:"text-sm text-gray-600"},$={key:1,class:"space-y-6"},Z={class:"card"},H={class:"flex justify-between items-center mb-2"},J={class:"text-sm font-medium text-gray-700"},O={class:"text-sm font-bold text-indigo-600"},X={class:"w-full bg-gray-200 rounded-full h-2"},Y={class:"card bg-gradient-to-r from-indigo-500 to-purple-600 text-white"},tt={class:"flex items-center justify-between"},et={class:"flex items-center space-x-3"},st={class:"text-3xl font-bold"},it={class:"text-right"},ot={class:"text-2xl font-bold"},nt={key:0,class:"card fade-in"},rt={class:"mb-6"},at={class:"text-sm text-indigo-600 font-medium mb-2"},lt={class:"text-2xl font-bold text-gray-900 mb-2"},ct={class:"flex items-center space-x-4 text-sm text-gray-600"},dt={class:"space-y-3"},ut=["onClick","disabled"],ht={key:1,class:"card slide-up"},gt={class:"flex items-center space-x-3 mb-2"},xt={class:"text-4xl"},mt={key:0,class:"text-gray-700 mt-4"},vt={key:2,class:"card text-center py-12"},ft={key:2,class:"space-y-6 slide-up"},pt={key:0,class:"card bg-gradient-to-r from-yellow-400 to-orange-500 text-white"},_t={class:"text-center py-6"},bt={class:"text-xl mb-4"},yt={class:"text-2xl font-bold"},wt={class:"card text-center"},Qt={class:"text-6xl mb-4"},kt={class:"text-gray-600 mb-8"},zt={class:"grid grid-cols-3 gap-4 mb-8"},qt={class:"bg-gray-50 rounded-lg p-4"},At={class:"text-3xl font-bold text-indigo-600"},Lt={class:"bg-gray-50 rounded-lg p-4"},Ct={class:"text-3xl font-bold text-green-600"},Nt={class:"bg-gray-50 rounded-lg p-4"},Tt={class:"text-3xl font-bold text-orange-600"},It={class:"flex gap-4"},Ft={class:"card"},St={class:"space-y-3"},Mt={class:"flex items-center space-x-3"},Dt={class:"text-2xl"},Pt={class:"text-sm text-gray-600"},jt={__name:"Quiz",setup(i){const e=G(),u=v(!1),a=v(null),g=v(!1),h=v(null),b=v(null);I(()=>{e.loadCategories()}),F(()=>{e.stopTimer()});const k=r=>({Allgemeinwissen:"üåç",Geographie:"üó∫Ô∏è",Geschichte:"üìú","Wissenschaft & Natur":"üî¨","Technologie & Computer":"üíª",Sport:"‚öΩ","Unterhaltung & Medien":"üé¨",Mathematik:"üî¢","Kunst & Kultur":"üé®",Literatur:"üìö",Politik:"üèõÔ∏è",Wirtschaft:"üíº",Sprachen:"üó£Ô∏è","Essen & Trinken":"üçï",Musik:"üéµ"})[r]||"‚ùì",z=r=>({easy:"‚≠ê Einfach",medium:"‚≠ê‚≠ê Mittel",hard:"‚≠ê‚≠ê‚≠ê Schwer"})[r]||r,Q=async r=>{g.value=!1,h.value=null,await e.startQuiz(r),b.value=Date.now()},q=async r=>{const s=Math.floor((Date.now()-b.value)/1e3);try{const m=await e.submitAnswer(r,s);a.value=m,u.value=!0}catch(m){console.error("Error submitting answer:",m)}},A=async()=>{if(u.value=!1,a.value=null,b.value=Date.now(),e.questionNumber>=e.totalQuestions){const r=await e.endQuiz();h.value=r,g.value=!0}else await e.loadNextQuestion()},L=()=>{const r=e.accuracy;return r===100?"üèÜ":r>=80?"üåü":r>=60?"üëç":r>=40?"üòä":"üí™"},C=()=>{const r=e.accuracy;return r===100?"Perfekt! Alle Fragen richtig beantwortet!":r>=80?"Ausgezeichnet! Sehr gute Leistung!":r>=60?"Gut gemacht! Weiter so!":r>=40?"Nicht schlecht! √úbung macht den Meister!":"Weiter √ºben! Du schaffst das!"},N=()=>{e.resetQuiz(),g.value=!1,h.value=null};return(r,s)=>{const m=P("router-link");return d(),c("div",j,[!n(e).quizActive&&!g.value?(d(),c("div",E,[s[2]||(s[2]=t("div",{class:"card"},[t("h1",{class:"text-3xl font-bold text-gray-900 mb-2"},"Quiz spielen üéÆ"),t("p",{class:"text-gray-600"},"W√§hle eine Kategorie oder spiele ein gemischtes Quiz")],-1)),t("div",V,[t("button",{onClick:s[0]||(s[0]=l=>Q(null)),class:"card hover:shadow-lg transition-shadow text-left group"},[...s[1]||(s[1]=[t("div",{class:"text-4xl mb-2"},"üé≤",-1),t("h3",{class:"font-bold text-gray-900 group-hover:text-indigo-600"},"Alle Kategorien",-1),t("p",{class:"text-sm text-gray-600"},"Gemischte Fragen",-1)])]),(d(!0),c(y,null,w(n(e).categories,l=>(d(),c("button",{key:l.id,onClick:_=>Q(l.id),class:"card hover:shadow-lg transition-shadow text-left group"},[t("div",B,o(k(l.name)),1),t("h3",K,o(l.name),1),t("p",U,o(l.question_count||"50")+" Fragen",1)],8,W))),128))])])):n(e).quizActive&&!g.value?(d(),c("div",$,[t("div",Z,[t("div",H,[t("span",J," Frage "+o(n(e).questionNumber)+" / "+o(n(e).totalQuestions),1),t("span",O,o(n(e).score)+" Punkte ",1)]),t("div",X,[t("div",{class:"bg-indigo-600 h-2 rounded-full transition-all duration-300",style:S({width:n(e).progress+"%"})},null,4)])]),t("div",Y,[t("div",tt,[t("div",et,[s[4]||(s[4]=t("div",{class:"text-3xl"},"‚è±Ô∏è",-1)),t("div",null,[s[3]||(s[3]=t("div",{class:"text-sm opacity-90"},"Verbleibende Zeit",-1)),t("div",st,o(n(e).timeLeft)+"s",1)])]),t("div",it,[s[5]||(s[5]=t("div",{class:"text-sm opacity-90"},"Genauigkeit",-1)),t("div",ot,o(n(e).accuracy)+"%",1)])])]),n(e).currentQuestion&&!u.value?(d(),c("div",nt,[t("div",rt,[t("div",at,o(n(e).currentQuestion.category),1),t("h2",lt,o(n(e).currentQuestion.question),1),t("div",ct,[t("span",null,o(z(n(e).currentQuestion.difficulty)),1),s[6]||(s[6]=t("span",null,"‚Ä¢",-1)),t("span",null,o(n(e).currentQuestion.points)+" Punkte",1)])]),t("div",dt,[(d(!0),c(y,null,w(n(e).currentQuestion.answers,l=>(d(),c("button",{key:l.id,onClick:_=>q(l.id),disabled:n(e).isLoading,class:"w-full text-left p-4 rounded-lg border-2 border-gray-200 hover:border-indigo-500 hover:bg-indigo-50 transition-all disabled:opacity-50"},o(l.answer_text),9,ut))),128))])])):u.value&&a.value?(d(),c("div",ht,[t("div",{class:x(["p-6 rounded-lg mb-4",a.value.correct?"bg-green-50":"bg-red-50"])},[t("div",gt,[t("div",xt,o(a.value.correct?"‚úÖ":"‚ùå"),1),t("div",null,[t("h3",{class:x(["text-xl font-bold",a.value.correct?"text-green-800":"text-red-800"])},o(a.value.correct?"Richtig!":"Leider falsch"),3),t("p",{class:x(["text-sm",a.value.correct?"text-green-600":"text-red-600"])}," +"+o(a.value.points_earned)+" Punkte ",3)])]),a.value.explanation?(d(),c("p",mt,o(a.value.explanation),1)):f("",!0)],2),t("button",{onClick:A,class:"w-full btn-primary"},o(n(e).questionNumber>=n(e).totalQuestions?"Quiz beenden":"N√§chste Frage"),1)])):f("",!0),n(e).isLoading?(d(),c("div",vt,[...s[7]||(s[7]=[t("div",{class:"spinner mx-auto mb-4"},null,-1),t("p",{class:"text-gray-600"},"L√§dt...",-1)])])):f("",!0)])):g.value&&h.value?(d(),c("div",ft,[h.value.bonusUnlocked?(d(),c("div",pt,[t("div",_t,[s[8]||(s[8]=t("div",{class:"text-6xl mb-4"},"üéâ",-1)),s[9]||(s[9]=t("h2",{class:"text-3xl font-bold mb-2"},"Gl√ºckwunsch!",-1)),t("p",bt,o(h.value.referral_bonus.message),1),t("p",yt,"+"+o(h.value.referral_bonus.bonus_paid)+" Bonus Coins!",1)])])):f("",!0),t("div",wt,[t("div",Qt,o(L()),1),s[14]||(s[14]=t("h2",{class:"text-3xl font-bold text-gray-900 mb-2"},"Quiz beendet!",-1)),t("p",kt,o(C()),1),t("div",zt,[t("div",qt,[t("div",At,o(n(e).score),1),s[10]||(s[10]=t("div",{class:"text-sm text-gray-600"},"Punkte",-1))]),t("div",Lt,[t("div",Ct,o(n(e).correctAnswers),1),s[11]||(s[11]=t("div",{class:"text-sm text-gray-600"},"Richtige",-1))]),t("div",Nt,[t("div",Tt,o(n(e).accuracy)+"%",1),s[12]||(s[12]=t("div",{class:"text-sm text-gray-600"},"Genauigkeit",-1))])]),t("div",It,[t("button",{onClick:N,class:"flex-1 btn-primary"}," Nochmal spielen "),M(m,{to:"/",class:"flex-1 btn-secondary"},{default:D(()=>[...s[13]||(s[13]=[R(" Zum Dashboard ",-1)])]),_:1})])]),t("div",Ft,[s[15]||(s[15]=t("h3",{class:"text-xl font-bold text-gray-900 mb-4"},"Antworten-√úbersicht",-1)),t("div",St,[(d(!0),c(y,null,w(n(e).answers,(l,_)=>(d(),c("div",{key:_,class:x(["flex items-center justify-between p-3 rounded-lg",l.correct?"bg-green-50":"bg-red-50"])},[t("div",Mt,[t("span",Dt,o(l.correct?"‚úÖ":"‚ùå"),1),t("div",null,[t("div",{class:x(["font-medium",l.correct?"text-green-800":"text-red-800"])}," Frage "+o(_+1),3),t("div",Pt,o(l.explanation),1)])]),t("div",{class:x(["font-bold",l.correct?"text-green-600":"text-red-600"])}," +"+o(l.points)+" Punkte ",3)],2))),128))])])])):f("",!0)])}}};export{jt as default};
