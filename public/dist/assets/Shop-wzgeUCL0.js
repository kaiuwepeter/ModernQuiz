import{d as L,r as A,p as B,e as z,g as i,i as e,h as y,t as r,m as o,n as x,F as f,l as v,y as j,z as F,o as d}from"./vendor-CZScdcBs.js";import{s as b,u as m}from"./index-CAiYc5NE.js";const q=L("shop",{state:()=>({powerups:[],inventory:[],isLoading:!1,selectedPowerup:null,showPurchaseModal:!1,purchaseQuantity:1,selectedCurrency:"auto",lastPurchase:null}),getters:{powerupsByCategory:n=>{const t={};return n.powerups.forEach(u=>{const p=u.category||"Sonstige";t[p]||(t[p]=[]),t[p].push(u)}),t},getInventoryCount:n=>t=>{const u=n.inventory.find(p=>p.powerup_id===t);return(u==null?void 0:u.quantity)||0},totalCost:n=>n.selectedPowerup?n.selectedPowerup.price*n.purchaseQuantity:0,canAfford:n=>{const t=m();if(!n.selectedPowerup||!t.user)return!1;const u=n.selectedPowerup.price*n.purchaseQuantity;return n.selectedCurrency==="coins"?t.user.coins>=u:n.selectedCurrency==="bonus_coins"?t.user.bonus_coins>=u:n.selectedCurrency==="auto"?t.user.bonus_coins+t.user.coins>=u:!1}},actions:{async loadPowerups(){try{this.isLoading=!0;const n=await b.getPowerups();this.powerups=n.data}catch(n){console.error("Failed to load powerups:",n)}finally{this.isLoading=!1}},async loadInventory(){try{const n=await b.getInventory();this.inventory=n.data}catch(n){console.error("Failed to load inventory:",n)}},openPurchaseModal(n){this.selectedPowerup=n,this.purchaseQuantity=1,this.selectedCurrency="auto",this.showPurchaseModal=!0},closePurchaseModal(){this.showPurchaseModal=!1,this.selectedPowerup=null,this.purchaseQuantity=1,this.selectedCurrency="auto"},async purchase(){if(!(!this.canAfford||!this.selectedPowerup))try{this.isLoading=!0;const n=await b.purchase(this.selectedPowerup.id,this.purchaseQuantity,this.selectedCurrency);return await m().fetchUser(),await this.loadInventory(),this.lastPurchase={powerup:this.selectedPowerup,quantity:this.purchaseQuantity,cost:n.data.total_cost,currency:n.data.currency_used},this.closePurchaseModal(),setTimeout(()=>{this.lastPurchase=null},5e3),n.data}catch(n){throw console.error("Purchase failed:",n),n}finally{this.isLoading=!1}},incrementQuantity(){this.purchaseQuantity<99&&this.purchaseQuantity++},decrementQuantity(){this.purchaseQuantity>1&&this.purchaseQuantity--}}}),D={class:"max-w-7xl mx-auto space-y-6"},K={class:"card"},$={class:"flex items-center justify-between"},E={class:"text-right"},V={class:"flex gap-4"},T={class:"bg-yellow-50 px-4 py-2 rounded-lg border border-yellow-200"},Z={class:"text-2xl font-bold text-yellow-700"},N={class:"bg-orange-50 px-4 py-2 rounded-lg border border-orange-200"},G={class:"text-2xl font-bold text-orange-700"},H={key:0,class:"card bg-gradient-to-r from-green-500 to-emerald-600 text-white slide-up"},U={class:"flex items-center justify-between"},J={class:"flex items-center space-x-3"},O={class:"text-sm opacity-90"},R={class:"text-right"},W={class:"text-2xl font-bold"},X={class:"text-sm opacity-90"},Y={class:"card"},ee={class:"flex gap-4 border-b border-gray-200"},te={key:1,class:"space-y-6"},se={key:0,class:"card text-center py-12"},oe={class:"text-xl font-bold text-gray-900"},ne={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},re=["onClick"],ie={class:"text-5xl mb-3 text-center"},de={class:"text-lg font-bold text-gray-900 mb-2 group-hover:text-indigo-600 transition-colors"},le={class:"text-sm text-gray-600 mb-4"},ae={class:"flex items-center justify-between"},ce={class:"flex items-center space-x-2"},ue={class:"text-xl font-bold text-yellow-600"},ye={key:0,class:"bg-indigo-100 text-indigo-700 px-3 py-1 rounded-full text-sm font-medium"},pe={key:0,class:"mt-3 pt-3 border-t border-gray-100"},xe={class:"text-xs text-gray-500 space-y-1"},ge={key:0},he={key:1},fe={key:2},ve={key:3},be={key:2,class:"card text-center py-12"},me={key:2,class:"space-y-4"},_e={key:0,class:"card text-center py-12"},we={key:1,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},Pe={class:"flex items-start justify-between mb-3"},ke={class:"flex items-center space-x-3"},Ce={class:"text-4xl"},Qe={class:"font-bold text-gray-900"},Se={class:"text-sm text-gray-600"},Ie={class:"bg-indigo-50 rounded-lg p-3 text-center"},Me={class:"text-3xl font-bold text-indigo-600"},Le={class:"mt-3 pt-3 border-t border-gray-100 text-xs text-gray-500"},Ae={key:2,class:"card text-center py-12"},Be={key:3,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},ze={class:"bg-white rounded-lg max-w-md w-full p-6 space-y-4 slide-up"},je={class:"flex items-start justify-between"},Fe={class:"flex items-center space-x-3"},qe={class:"text-5xl"},De={class:"text-xl font-bold text-gray-900"},Ke={class:"text-sm text-gray-600"},$e={key:0,class:"bg-gray-50 rounded-lg p-3"},Ee={class:"text-sm text-gray-600 space-y-1"},Ve={key:0},Te={key:1},Ze={key:2},Ne={key:3},Ge={class:"flex items-center space-x-3"},He=["disabled"],Ue=["disabled"],Je={class:"grid grid-cols-3 gap-2"},Oe={class:"bg-indigo-50 rounded-lg p-4"},Re={class:"flex items-center justify-between"},We={class:"text-2xl font-bold text-indigo-600"},Xe={class:"text-sm text-gray-600 mt-1"},Ye={class:"text-sm text-gray-600"},et={class:"flex justify-between"},tt={class:"font-medium"},st={class:"flex justify-between"},ot={class:"font-medium"},nt={class:"flex gap-3"},rt=["disabled"],it={key:0},dt={key:1},lt={key:2},yt={__name:"Shop",setup(n){const t=q(),u=m(),p=A("shop");B(()=>{t.loadPowerups(),t.loadInventory()});const Q=z(()=>t.inventory.reduce((l,s)=>l+s.quantity,0)),S=l=>({"Zeit-Powerups":"â±ï¸","Hilfs-Powerups":"ðŸ’¡","Punkte-Powerups":"â­","Spezial-Powerups":"âœ¨",Sonstige:"ðŸŽ"})[l]||"ðŸ“¦",g=l=>l.includes("Zeit")||l.includes("Time")?"â°":l.includes("50:50")||l.includes("Fifty")?"ðŸŽ¯":l.includes("Punkte")||l.includes("Points")?"â­":l.includes("Skip")||l.includes("Ãœberspringen")?"â­ï¸":l.includes("Freeze")||l.includes("Einfrieren")?"â„ï¸":l.includes("Hint")||l.includes("Tipp")?"ðŸ’¡":"ðŸŽ",_=l=>({auto:"Auto (Bonus + Coins)",coins:"Coins",bonus_coins:"Bonus Coins"})[l]||l,I=l=>new Date(l).toLocaleDateString("de-DE",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),M=async()=>{try{await t.purchase()}catch(l){console.error("Purchase error:",l),alert("Fehler beim Kauf. Bitte versuche es erneut.")}};return(l,s)=>{var w,P,k,C;return d(),i("div",D,[e("div",K,[e("div",$,[s[13]||(s[13]=e("div",null,[e("h1",{class:"text-3xl font-bold text-gray-900 mb-2"},"ðŸ›ï¸ Shop"),e("p",{class:"text-gray-600"},"Kaufe Powerups um deine Chancen im Quiz zu verbessern")],-1)),e("div",E,[e("div",V,[e("div",T,[s[11]||(s[11]=e("div",{class:"text-xs text-yellow-600 font-medium"},"Coins",-1)),e("div",Z,r(((w=o(u).user)==null?void 0:w.coins)||0),1)]),e("div",N,[s[12]||(s[12]=e("div",{class:"text-xs text-orange-600 font-medium"},"Bonus Coins",-1)),e("div",G,r(((P=o(u).user)==null?void 0:P.bonus_coins)||0),1)])])])])]),o(t).lastPurchase?(d(),i("div",H,[e("div",U,[e("div",J,[s[15]||(s[15]=e("div",{class:"text-4xl"},"âœ…",-1)),e("div",null,[s[14]||(s[14]=e("h3",{class:"text-lg font-bold"},"Kauf erfolgreich!",-1)),e("p",O,r(o(t).lastPurchase.quantity)+"x "+r(o(t).lastPurchase.powerup.name)+" gekauft ",1)])]),e("div",R,[e("div",W,"-"+r(o(t).lastPurchase.cost),1),e("div",X,r(_(o(t).lastPurchase.currency)),1)])])])):y("",!0),e("div",Y,[e("div",ee,[e("button",{onClick:s[0]||(s[0]=a=>p.value="shop"),class:x(["px-4 py-2 font-medium transition-colors",p.value==="shop"?"text-indigo-600 border-b-2 border-indigo-600":"text-gray-600 hover:text-gray-900"])}," ðŸ›’ Powerups kaufen ",2),e("button",{onClick:s[1]||(s[1]=a=>p.value="inventory"),class:x(["px-4 py-2 font-medium transition-colors",p.value==="inventory"?"text-indigo-600 border-b-2 border-indigo-600":"text-gray-600 hover:text-gray-900"])}," ðŸŽ’ Mein Inventar ("+r(Q.value)+") ",3)])]),p.value==="shop"?(d(),i("div",te,[o(t).isLoading&&o(t).powerups.length===0?(d(),i("div",se,[...s[16]||(s[16]=[e("div",{class:"spinner mx-auto mb-4"},null,-1),e("p",{class:"text-gray-600"},"Lade Powerups...",-1)])])):(d(!0),i(f,{key:1},v(o(t).powerupsByCategory,(a,h)=>(d(),i("div",{key:h,class:"space-y-4"},[e("h2",oe,r(S(h))+" "+r(h),1),e("div",ne,[(d(!0),i(f,null,v(a,c=>(d(),i("div",{key:c.id,class:"card hover:shadow-lg transition-all group cursor-pointer",onClick:at=>o(t).openPurchaseModal(c)},[e("div",ie,r(g(c.name)),1),e("h3",de,r(c.name),1),e("p",le,r(c.description),1),e("div",ae,[e("div",ce,[e("div",ue,r(c.price),1),s[17]||(s[17]=e("div",{class:"text-sm text-gray-500"},"Coins",-1))]),o(t).getInventoryCount(c.id)>0?(d(),i("div",ye,r(o(t).getInventoryCount(c.id))+"x im Inventar ",1)):y("",!0)]),c.effects?(d(),i("div",pe,[e("div",xe,[c.effects.extra_time?(d(),i("div",ge,"â±ï¸ +"+r(c.effects.extra_time)+"s Zeit",1)):y("",!0),c.effects.remove_answers?(d(),i("div",he,"âŒ "+r(c.effects.remove_answers)+" Antworten entfernen",1)):y("",!0),c.effects.point_multiplier?(d(),i("div",fe,"âœ¨ "+r(c.effects.point_multiplier)+"x Punkte",1)):y("",!0),c.effects.skip_question?(d(),i("div",ve,"â­ï¸ Frage Ã¼berspringen")):y("",!0)])])):y("",!0)],8,re))),128))])]))),128)),!o(t).isLoading&&o(t).powerups.length===0?(d(),i("div",be,[...s[18]||(s[18]=[e("div",{class:"text-6xl mb-4"},"ðŸª",-1),e("h3",{class:"text-xl font-bold text-gray-900 mb-2"},"Keine Powerups verfÃ¼gbar",-1),e("p",{class:"text-gray-600"},"Schau spÃ¤ter wieder vorbei!",-1)])])):y("",!0)])):p.value==="inventory"?(d(),i("div",me,[o(t).isLoading&&o(t).inventory.length===0?(d(),i("div",_e,[...s[19]||(s[19]=[e("div",{class:"spinner mx-auto mb-4"},null,-1),e("p",{class:"text-gray-600"},"Lade Inventar...",-1)])])):o(t).inventory.length>0?(d(),i("div",we,[(d(!0),i(f,null,v(o(t).inventory,a=>(d(),i("div",{key:a.id,class:"card"},[e("div",Pe,[e("div",ke,[e("div",Ce,r(g(a.powerup_name)),1),e("div",null,[e("h3",Qe,r(a.powerup_name),1),e("p",Se,r(a.powerup_description),1)])])]),e("div",Ie,[e("div",Me,r(a.quantity),1),s[20]||(s[20]=e("div",{class:"text-sm text-indigo-700"},"VerfÃ¼gbar",-1))]),e("div",Le," Gekauft: "+r(I(a.purchased_at)),1)]))),128))])):(d(),i("div",Ae,[s[21]||(s[21]=e("div",{class:"text-6xl mb-4"},"ðŸŽ’",-1)),s[22]||(s[22]=e("h3",{class:"text-xl font-bold text-gray-900 mb-2"},"Dein Inventar ist leer",-1)),s[23]||(s[23]=e("p",{class:"text-gray-600 mb-4"},"Kaufe Powerups um deine Chancen zu verbessern!",-1)),e("button",{onClick:s[2]||(s[2]=a=>p.value="shop"),class:"btn-primary"}," Zum Shop ")]))])):y("",!0),o(t).showPurchaseModal?(d(),i("div",Be,[e("div",ze,[e("div",je,[e("div",Fe,[e("div",qe,r(g(o(t).selectedPowerup.name)),1),e("div",null,[e("h3",De,r(o(t).selectedPowerup.name),1),e("p",Ke,r(o(t).selectedPowerup.description),1)])]),e("button",{onClick:s[3]||(s[3]=(...a)=>o(t).closePurchaseModal&&o(t).closePurchaseModal(...a)),class:"text-gray-400 hover:text-gray-600"},[...s[24]||(s[24]=[e("span",{class:"text-2xl"},"Ã—",-1)])])]),o(t).selectedPowerup.effects?(d(),i("div",$e,[s[25]||(s[25]=e("div",{class:"text-sm font-medium text-gray-700 mb-2"},"Effekte:",-1)),e("div",Ee,[o(t).selectedPowerup.effects.extra_time?(d(),i("div",Ve,"â±ï¸ +"+r(o(t).selectedPowerup.effects.extra_time)+" Sekunden Zeit",1)):y("",!0),o(t).selectedPowerup.effects.remove_answers?(d(),i("div",Te,"âŒ Entfernt "+r(o(t).selectedPowerup.effects.remove_answers)+" falsche Antworten",1)):y("",!0),o(t).selectedPowerup.effects.point_multiplier?(d(),i("div",Ze,"âœ¨ "+r(o(t).selectedPowerup.effects.point_multiplier)+"x Punkte-Multiplikator",1)):y("",!0),o(t).selectedPowerup.effects.skip_question?(d(),i("div",Ne,"â­ï¸ Ãœberspringt die Frage")):y("",!0)])])):y("",!0),e("div",null,[s[26]||(s[26]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Anzahl:",-1)),e("div",Ge,[e("button",{onClick:s[4]||(s[4]=(...a)=>o(t).decrementQuantity&&o(t).decrementQuantity(...a)),class:"w-10 h-10 rounded-lg border-2 border-gray-300 hover:border-indigo-500 hover:bg-indigo-50 font-bold transition-colors",disabled:o(t).purchaseQuantity<=1}," - ",8,He),j(e("input",{"onUpdate:modelValue":s[5]||(s[5]=a=>o(t).purchaseQuantity=a),type:"number",min:"1",max:"99",class:"input text-center flex-1"},null,512),[[F,o(t).purchaseQuantity,void 0,{number:!0}]]),e("button",{onClick:s[6]||(s[6]=(...a)=>o(t).incrementQuantity&&o(t).incrementQuantity(...a)),class:"w-10 h-10 rounded-lg border-2 border-gray-300 hover:border-indigo-500 hover:bg-indigo-50 font-bold transition-colors",disabled:o(t).purchaseQuantity>=99}," + ",8,Ue)])]),e("div",null,[s[27]||(s[27]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Bezahlen mit:",-1)),e("div",Je,[e("button",{onClick:s[7]||(s[7]=a=>o(t).selectedCurrency="auto"),class:x(["px-4 py-2 rounded-lg border-2 transition-colors text-sm font-medium",o(t).selectedCurrency==="auto"?"border-indigo-500 bg-indigo-50 text-indigo-700":"border-gray-200 text-gray-700 hover:border-gray-300"])}," ðŸ¤– Auto ",2),e("button",{onClick:s[8]||(s[8]=a=>o(t).selectedCurrency="coins"),class:x(["px-4 py-2 rounded-lg border-2 transition-colors text-sm font-medium",o(t).selectedCurrency==="coins"?"border-yellow-500 bg-yellow-50 text-yellow-700":"border-gray-200 text-gray-700 hover:border-gray-300"])}," ðŸª™ Coins ",2),e("button",{onClick:s[9]||(s[9]=a=>o(t).selectedCurrency="bonus_coins"),class:x(["px-4 py-2 rounded-lg border-2 transition-colors text-sm font-medium",o(t).selectedCurrency==="bonus_coins"?"border-orange-500 bg-orange-50 text-orange-700":"border-gray-200 text-gray-700 hover:border-gray-300"])}," â­ Bonus ",2)]),s[28]||(s[28]=e("p",{class:"text-xs text-gray-500 mt-2"}," Auto verwendet zuerst Bonus Coins, dann normale Coins ",-1))]),e("div",Oe,[e("div",Re,[s[29]||(s[29]=e("div",{class:"font-medium text-gray-700"},"Gesamtpreis:",-1)),e("div",We,r(o(t).totalCost),1)]),e("div",Xe,r(_(o(t).selectedCurrency)),1)]),e("div",Ye,[e("div",et,[s[30]||(s[30]=e("span",null,"VerfÃ¼gbare Coins:",-1)),e("span",tt,r(((k=o(u).user)==null?void 0:k.coins)||0),1)]),e("div",st,[s[31]||(s[31]=e("span",null,"VerfÃ¼gbare Bonus Coins:",-1)),e("span",ot,r(((C=o(u).user)==null?void 0:C.bonus_coins)||0),1)])]),e("div",nt,[e("button",{onClick:s[10]||(s[10]=(...a)=>o(t).closePurchaseModal&&o(t).closePurchaseModal(...a)),class:"flex-1 btn-secondary"}," Abbrechen "),e("button",{onClick:M,disabled:!o(t).canAfford||o(t).isLoading,class:"flex-1 btn-primary disabled:opacity-50 disabled:cursor-not-allowed"},[o(t).isLoading?(d(),i("span",it,"Kaufen...")):o(t).canAfford?(d(),i("span",lt,"Kaufen")):(d(),i("span",dt,"Nicht genug Coins"))],8,rt)])])])):y("",!0)])}}};export{yt as default};
